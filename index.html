<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∑‡∏ö‡∏Ñ‡πâ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ | ‡∏ß‡∏≠‡∏®.‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-burgundy: #800000;    /* ‡πÅ‡∏î‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏´‡∏°‡∏π‡∏´‡∏•‡∏±‡∏Å */
            --dark-burgundy: #4D0000;       /* ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ */
            --accent-gold: #D4AF37;         /* ‡∏ó‡∏≠‡∏á‡∏´‡∏£‡∏π‡∏´‡∏£‡∏≤ */
            --soft-text: #444444;           /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏õ‡∏ß‡∏î‡∏ï‡∏≤ */
            --muted-text: #777777;           /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà/‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≠‡∏á */
            --success-green: #157347;       /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á */
        }

        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #F4F6F9;
            color: var(--soft-text);
            padding: 40px 15px;
        }

        .main-card { 
            border-radius: 20px; 
            border: none;
            box-shadow: 0 12px 24px rgba(0,0,0,0.08);
            background: #ffffff;
            max-width: 1280px;
            margin: auto;
            overflow: hidden;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ Header ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏´‡∏£‡∏π‡∏Ç‡∏∂‡πâ‡∏ô */
        .header { 
            background: linear-gradient(135deg, var(--dark-burgundy), var(--primary-burgundy));
            color: #ffffff; 
            padding: 45px 20px; 
            text-align: center;
            border-bottom: 4px solid var(--accent-gold);
        }

        .header h2 { font-weight: 700; color: #ffffff; margin-bottom: 10px; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); }
        .header .sub-text { color: var(--accent-gold); font-weight: 500; font-size: 1.1rem; }

        .search-box {
            background: #ffffff;
            padding: 30px;
            border-bottom: 1px solid #eeeeee;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÅ‡∏û‡∏á */
        .btn-print { 
            background: linear-gradient(to bottom, #f9e18c, #d4af37);
            color: var(--dark-burgundy);
            border: 1px solid #c59d2a;
            font-weight: 700;
            border-radius: 10px;
            padding: 12px;
            transition: all 0.3s;
        }

        .btn-print:hover { 
            filter: brightness(1.05);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
            color: var(--dark-burgundy);
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
        .table thead th { 
            background-color: #FDFDFD;
            color: var(--dark-burgundy); /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° */
            font-weight: 600;
            border-bottom: 2px solid #E9ECEF;
            padding: 15px;
        }

        /* ‡∏™‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ */
        .company-name { color: var(--dark-burgundy); font-weight: 700; font-size: 1.05rem; }

        /* ‡∏™‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô (Badge) */
        .badge-work {
            background-color: #FFF5F5;
            color: var(--primary-burgundy);
            border: 1px solid rgba(128, 0, 0, 0.1);
            padding: 6px 14px;
            border-radius: 8px;
            font-weight: 600;
        }

        /* ‡∏™‡∏µ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á */
        .salary { color: var(--success-green); font-weight: 700; font-size: 1.1rem; }

        /* ‡∏™‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà */
        .details { color: var(--soft-text); line-height: 1.6; }
        .address { color: var(--muted-text); font-size: 0.9rem; }

        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .main-card { box-shadow: none; }
            .company-name, .badge-work { color: #000 !important; } /* ‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡πâ‡∏î‡∏≥‡∏™‡∏ô‡∏¥‡∏ó‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
        }
    </style>
</head>
<body>

<div class="container-fluid">
    <div class="card main-card">
        <div class="header">
            <h2>‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢</h2>
            <div class="sub-text">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∑‡∏ö‡∏Ñ‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</div>
        </div>
        
        <div class="search-box no-print">
            <div class="row g-3 align-items-center">
                <div class="col-md-9">
                    <input type="text" id="searchInput" class="form-control" 
                           placeholder="üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£, ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà, ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô..." 
                           onkeyup="filterData()">
                </div>
                <div class="col-md-3">
                    <button onclick="window.print()" class="btn btn-print w-100">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ</button>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table align-middle">
                <thead>
                    <tr>
                        <th style="width: 18%;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£</th>
                        <th style="width: 20%;">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£</th>
                        <th style="width: 20%;">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</th>
                        <th style="width: 15%;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</th>
                        <th style="width: 15%;">‡∏¢‡∏π‡∏ô‡∏¥‡∏ü‡∏≠‡∏£‡πå‡∏°</th>
                        <th style="width: 12%; text-align: right;">‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    const URL = "https://script.google.com/macros/s/AKfycbwbciXYFvVEVm_QpOjs3l3BwGB2PkPJjBo3ZOaoewi5kYHiFzc5C4xYY6y_sLRHL_QH/exec"; 
    let allData = [];

    async function fetchData() {
        try {
            const res = await fetch(URL);
            allData = await res.json();
            renderTable(allData);
        } catch (e) {
            document.getElementById('tableBody').innerHTML = "<tr><td colspan='6' class='text-center p-5 text-danger'>‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</td></tr>";
        }
    }

    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = data.map(item => `
            <tr>
                <td class="company-name">${item['‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£'] || '-'}</td>
                <td class="details"><small>${item['‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£'] || '-'}</small></td>
                <td class="address">${item['‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà'] || '-'}</td>
                <td><span class="badge-work">${item['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô'] || '-'}</span></td>
                <td class="details"><small>${item['‡∏¢‡∏π‡∏ô‡∏¥‡∏ü‡∏≠‡∏£‡πå‡∏°'] || '-'}</small></td>
                <td class="text-end salary">${item['‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á'] || '-'}</td>
            </tr>
        `).join('');
    }

    function filterData() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const filtered = allData.filter(item => 
            Object.values(item).some(val => String(val).toLowerCase().includes(term))
        );
        renderTable(filtered);
    }

    fetchData();
</script>
</body>
</html>
