<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∑‡∏ö‡∏Ñ‡πâ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; padding: 20px; background-color: #f8f9fa; }
        .card { border-radius: 15px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .header { background: #800000; color: white; padding: 20px; border-radius: 15px 15px 0 0; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <div class="header">
            <h2>‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢</h2>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∑‡∏ö‡∏Ñ‡πâ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£</p>
        </div>
        <div class="p-4">
            <input type="text" id="search" class="form-control mb-3" placeholder="üîç ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="searchTable()">
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</th>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</th>
                            <th>‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr><td colspan="5" class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    // ‚ö†Ô∏è ‡∏ô‡∏≥ URL ‡∏à‡∏≤‡∏Å Google Apps Script ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ‚ö†Ô∏è
    const URL = "https://script.google.com/macros/s/AKfycbwbciXYFvVEVm_QpOjs3l3BwGB2PkPJjBo3ZOaoewi5kYHiFzc5C4xYY6y_sLRHL_QH/exec"; 

    let dataList = [];

    async function getData() {
        try {
            const res = await fetch(URL);
            dataList = await res.json();
            showData(dataList);
        } catch (e) {
            document.getElementById('tableBody').innerHTML = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠";
        }
    }

    function showData(items) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = items.map(item => `
            <tr>
                <td><b>${item['‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£'] || '-'}</b></td>
                <td>${item['‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£'] || '-'}</td>
                <td>${item['‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà'] || '-'}</td>
                <td>${item['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô'] || '-'}</td>
                <td>${item['‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á'] || '-'}</td>
            </tr>
        `).join('');
    }

    function searchTable() {
        const word = document.getElementById('search').value.toLowerCase();
        const filtered = dataList.filter(i => Object.values(i).some(v => String(v).toLowerCase().includes(word)));
        showData(filtered);
    }

    getData();
</script>
</body>
</html>